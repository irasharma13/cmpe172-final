{"ast":null,"code":"import \"source-map-support/register\";\nimport uuid from 'uuid';\nimport aws from 'aws-sdk';\nimport * as ddbLib from './lib/ddb-lib';\nimport { success, failure } from './libs/response-objects'; //const ddb = new aws.DynamoDB.DocumentClient();\n\nexport async function main(event, context, callback) {\n  const req_body = JSON.parse(event.body);\n  const tableParams = {\n    TableName: process.env.tableName,\n    Item: {\n      userid: event.requestContext.identity.cognitoIdentityId,\n      uploadid: uuid.v1(),\n      creationTime: Date.now(),\n      imageDescription: req_body.content,\n      attachment: req_body.attachment\n    }\n  };\n\n  try {\n    await ddbLib.call(\"put\", tableParams);\n    return success(tableParams.Item);\n  } catch (e) {\n    console.log(e);\n    return failure({\n      status: false\n    });\n  } // ddb.put(table_params, (error, data) => {\n  // \t//set resp headers to enable cors\n  // \tconst headers = {\n  // \t\t\"Access-Control-Allow-Origin\": \"*\",\n  // \t\t\"Access-Control-Allow-Credentials\": true\n  // \t};\n  // \tif (error) {\n  // \t\tconsole.log(error);\n  // \t\tconst resp = {\n  // \t\t\tstatusCode: 500,\n  // \t\t\theaders: headers,\n  // \t\t\tbody: JSON.stringify({status:false})\n  // \t\t};\n  // \t\tcallback(null, resp);\n  // \t\treturn;\n  // \t}\n  // \tconst resp = {\n  // \t\tstatusCode: 200,\n  // \t\theaders: headers,\n  // \t\tbody: JSON.stringify(table_params.Item)\n  // \t};\n  // \tcallback(null, resp);\n  // });\n\n}","map":{"version":3,"sources":["/Users/Maq0831/Desktop/aws/eos/eos-backend/create.js"],"names":["uuid","aws","ddbLib","success","failure","main","event","context","callback","req_body","JSON","parse","body","tableParams","TableName","process","env","tableName","Item","userid","requestContext","identity","cognitoIdentityId","uploadid","v1","creationTime","Date","now","imageDescription","content","attachment","call","e","console","log","status"],"mappings":";AAAA,OAAOA,IAAP,MAAiB,MAAjB;AACA,OAAOC,GAAP,MAAgB,SAAhB;AACA,OAAO,KAAKC,MAAZ,MAAwB,eAAxB;AACA,SAAQC,OAAR,EAAiBC,OAAjB,QAA+B,yBAA/B,C,CAEA;;AAEA,OAAO,eAAeC,IAAf,CAAoBC,KAApB,EAA2BC,OAA3B,EAAoCC,QAApC,EAA8C;AACpD,QAAMC,QAAQ,GAAGC,IAAI,CAACC,KAAL,CAAWL,KAAK,CAACM,IAAjB,CAAjB;AACA,QAAMC,WAAW,GAAG;AACnBC,IAAAA,SAAS,EAAEC,OAAO,CAACC,GAAR,CAAYC,SADJ;AAEnBC,IAAAA,IAAI,EAAE;AACLC,MAAAA,MAAM,EAAEb,KAAK,CAACc,cAAN,CAAqBC,QAArB,CAA8BC,iBADjC;AAELC,MAAAA,QAAQ,EAAEvB,IAAI,CAACwB,EAAL,EAFL;AAGLC,MAAAA,YAAY,EAAEC,IAAI,CAACC,GAAL,EAHT;AAILC,MAAAA,gBAAgB,EAAEnB,QAAQ,CAACoB,OAJtB;AAKLC,MAAAA,UAAU,EAAErB,QAAQ,CAACqB;AALhB;AAFa,GAApB;;AAWA,MAAI;AACH,UAAM5B,MAAM,CAAC6B,IAAP,CAAY,KAAZ,EAAmBlB,WAAnB,CAAN;AACA,WAAOV,OAAO,CAACU,WAAW,CAACK,IAAb,CAAd;AACA,GAHD,CAGC,OAAOc,CAAP,EAAS;AACTC,IAAAA,OAAO,CAACC,GAAR,CAAYF,CAAZ;AACA,WAAO5B,OAAO,CAAC;AAAC+B,MAAAA,MAAM,EAAC;AAAR,KAAD,CAAd;AACA,GAnBmD,CAqBpD;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA","sourcesContent":["import uuid from 'uuid';\nimport aws from 'aws-sdk';\nimport * as ddbLib from './lib/ddb-lib';\nimport {success, failure} from './libs/response-objects';\n\n//const ddb = new aws.DynamoDB.DocumentClient();\n\nexport async function main(event, context, callback) {\n\tconst req_body = JSON.parse(event.body);\n\tconst tableParams = {\n\t\tTableName: process.env.tableName,\n\t\tItem: {\n\t\t\tuserid: event.requestContext.identity.cognitoIdentityId,\n\t\t\tuploadid: uuid.v1(),\n\t\t\tcreationTime: Date.now(),\n\t\t\timageDescription: req_body.content,\n\t\t\tattachment: req_body.attachment\n\t\t}\n\t};\n\n\ttry {\n\t\tawait ddbLib.call(\"put\", tableParams);\n\t\treturn success(tableParams.Item);\n\t}catch (e){\n\t\tconsole.log(e);\n\t\treturn failure({status:false});\n\t}\n\n\t// ddb.put(table_params, (error, data) => {\n\t// \t//set resp headers to enable cors\n\t// \tconst headers = {\n\t// \t\t\"Access-Control-Allow-Origin\": \"*\",\n\t// \t\t\"Access-Control-Allow-Credentials\": true\n\t// \t};\n\n\t// \tif (error) {\n\t// \t\tconsole.log(error);\n\t// \t\tconst resp = {\n\t// \t\t\tstatusCode: 500,\n\t// \t\t\theaders: headers,\n\t// \t\t\tbody: JSON.stringify({status:false})\n\t// \t\t};\n\t// \t\tcallback(null, resp);\n\t// \t\treturn;\n\t// \t}\n\n\t// \tconst resp = {\n\t// \t\tstatusCode: 200,\n\t// \t\theaders: headers,\n\t// \t\tbody: JSON.stringify(table_params.Item)\n\t// \t};\n\t// \tcallback(null, resp);\n\t// });\n}"]},"metadata":{},"sourceType":"module"}