{"ast":null,"code":"import \"source-map-support/register\";\nimport uuid from 'uuid';\nimport aws from 'aws-sdk';\nconst ddb = new aws.DynamoDB.DocumentClient();\nexport function main(event, context, callback) {\n  const req_body = JSON.parse(event.body);\n  const table_params = {\n    TableName: process.env.tableName,\n    Item: {\n      userId: event.requestContext.identity.cognitoIdentityId,\n      uploadid: uuid.v1(),\n      creationTime: Date.now(),\n      imageDescription: req_body.content,\n      attachment: req_body.attachment\n    }\n  };\n  ddb.put(table_params, (error, data) => {\n    //set resp headers to enable cors\n    const headers = {\n      \"Access-Control-Allow-Origin\": \"*\",\n      \"Access-Control-Allow-Credentials\": true\n    };\n\n    if (error) {\n      const resp = {\n        statusCode: 500,\n        headers: headers,\n        body: JSON.stringify({\n          status: false\n        })\n      };\n      callback(null, resp);\n      return;\n    }\n\n    const resp = {\n      statusCode: 200,\n      headers: headers,\n      body: JSON.stringify(table_params.Item)\n    };\n    callback(null, resp);\n  });\n}","map":{"version":3,"sources":["/Users/Maq0831/Desktop/aws/eos/eos-backend/create.js"],"names":["uuid","aws","ddb","DynamoDB","DocumentClient","main","event","context","callback","req_body","JSON","parse","body","table_params","TableName","process","env","tableName","Item","userId","requestContext","identity","cognitoIdentityId","uploadid","v1","creationTime","Date","now","imageDescription","content","attachment","put","error","data","headers","resp","statusCode","stringify","status"],"mappings":";AAAA,OAAOA,IAAP,MAAiB,MAAjB;AACA,OAAOC,GAAP,MAAgB,SAAhB;AAEA,MAAMC,GAAG,GAAG,IAAID,GAAG,CAACE,QAAJ,CAAaC,cAAjB,EAAZ;AAEA,OAAO,SAASC,IAAT,CAAcC,KAAd,EAAqBC,OAArB,EAA8BC,QAA9B,EAAwC;AAC9C,QAAMC,QAAQ,GAAGC,IAAI,CAACC,KAAL,CAAWL,KAAK,CAACM,IAAjB,CAAjB;AAEA,QAAMC,YAAY,GAAG;AACpBC,IAAAA,SAAS,EAAEC,OAAO,CAACC,GAAR,CAAYC,SADH;AAEpBC,IAAAA,IAAI,EAAE;AACLC,MAAAA,MAAM,EAAEb,KAAK,CAACc,cAAN,CAAqBC,QAArB,CAA8BC,iBADjC;AAELC,MAAAA,QAAQ,EAAEvB,IAAI,CAACwB,EAAL,EAFL;AAGLC,MAAAA,YAAY,EAAEC,IAAI,CAACC,GAAL,EAHT;AAILC,MAAAA,gBAAgB,EAAEnB,QAAQ,CAACoB,OAJtB;AAKLC,MAAAA,UAAU,EAAErB,QAAQ,CAACqB;AALhB;AAFc,GAArB;AAWA5B,EAAAA,GAAG,CAAC6B,GAAJ,CAAQlB,YAAR,EAAsB,CAACmB,KAAD,EAAQC,IAAR,KAAiB;AACtC;AACA,UAAMC,OAAO,GAAG;AACf,qCAA+B,GADhB;AAEf,0CAAoC;AAFrB,KAAhB;;AAKA,QAAIF,KAAJ,EAAW;AACV,YAAMG,IAAI,GAAG;AACZC,QAAAA,UAAU,EAAE,GADA;AAEZF,QAAAA,OAAO,EAAEA,OAFG;AAGZtB,QAAAA,IAAI,EAAEF,IAAI,CAAC2B,SAAL,CAAe;AAACC,UAAAA,MAAM,EAAC;AAAR,SAAf;AAHM,OAAb;AAKA9B,MAAAA,QAAQ,CAAC,IAAD,EAAO2B,IAAP,CAAR;AACA;AACA;;AAED,UAAMA,IAAI,GAAG;AACZC,MAAAA,UAAU,EAAE,GADA;AAEZF,MAAAA,OAAO,EAAEA,OAFG;AAGZtB,MAAAA,IAAI,EAAEF,IAAI,CAAC2B,SAAL,CAAexB,YAAY,CAACK,IAA5B;AAHM,KAAb;AAKAV,IAAAA,QAAQ,CAAC,IAAD,EAAO2B,IAAP,CAAR;AACA,GAvBD;AAwBA","sourcesContent":["import uuid from 'uuid';\nimport aws from 'aws-sdk';\n\nconst ddb = new aws.DynamoDB.DocumentClient();\n\nexport function main(event, context, callback) {\n\tconst req_body = JSON.parse(event.body);\n\n\tconst table_params = {\n\t\tTableName: process.env.tableName,\n\t\tItem: {\n\t\t\tuserId: event.requestContext.identity.cognitoIdentityId,\n\t\t\tuploadid: uuid.v1(),\n\t\t\tcreationTime: Date.now(),\n\t\t\timageDescription: req_body.content,\n\t\t\tattachment: req_body.attachment\n\t\t}\n\t};\n\n\tddb.put(table_params, (error, data) => {\n\t\t//set resp headers to enable cors\n\t\tconst headers = {\n\t\t\t\"Access-Control-Allow-Origin\": \"*\",\n\t\t\t\"Access-Control-Allow-Credentials\": true\n\t\t};\n\n\t\tif (error) {\n\t\t\tconst resp = {\n\t\t\t\tstatusCode: 500,\n\t\t\t\theaders: headers,\n\t\t\t\tbody: JSON.stringify({status:false})\n\t\t\t};\n\t\t\tcallback(null, resp);\n\t\t\treturn;\n\t\t}\n\n\t\tconst resp = {\n\t\t\tstatusCode: 200,\n\t\t\theaders: headers,\n\t\t\tbody: JSON.stringify(table_params.Item)\n\t\t};\n\t\tcallback(null, resp);\n\t});\n}"]},"metadata":{},"sourceType":"module"}